%----------------------------------------------------------------------------
\clearpage\section{Domain-specific Language}
%----------------------------------------------------------------------------

In order to make it easier to test both the XSTS and SysML transformations, I created an \textbf{Xtext} domain-specific language. Easy readability and writing was not one of the main priorities, because the end goal is to have a higher-level systems modelling language as a source. As a result, many many constructs are inherently repetitive to write.

\subsection{Language elements}

The following section gives high level introduction into the syntax of the Gamma Activity DSL.

\subsubsection*{Inherited from Gamma}

Some of the used constructs were reused from the other languages of the Gamma framework in order to provide tighter integration.

Lehet ez is rossz helyen van.. Végülis visszamehet a background részre

\subsubsection*{Pins}\label{sssec:pins}

Pins can be declared the following way, where \verb|<direction>| can be either \verb|in| or \verb|out|, and \verb|type| a valid Gamma Expression type.

\begin{verbatim}
	<direction> <name> : <type>
\end{verbatim}

For example: 

\begin{verbatim}
	in examplePin : integer
\end{verbatim}

where the direction is \verb|in|, the name is \verb|examplePin| and the type is \verb|integer|.

\subsubsection*{Nodes}\label{sssec:nodes}

Nodes can be declared by stating the \verb|type| of the node and then it's name. The type determines the underlying meta element. See figure \ref{fig:semantic}

The available node types:

\begin{verbatim}
	initial InitialNode
	decision DecisionNode
	merge MergeNode
	fork ForkNode
	join JoinNode
	final FinalNode
	action ActionNode
\end{verbatim}

\subsubsection*{Flows}\label{sssec:flows}

The behaviour of the Activity can be described by stating \verb|data| or \verb|control| flows between two nodes. Flows may have \verb|guard|s on them, which limits when the flow can fire. Activities may only be from the current activity definition's children. Pins can be accessed using the \verb|.| accessor operator, the activity on the left hand side, and the pin's name on the right. The enclosing activity's name is \verb|self|.

Flows can be declared the following way, where \verb|<kind>| is the kind of flow, \verb|<source>| and \verb|<target>| is the source/target node or pin, and \verb|<guard>| is a Gamma Expression returning boolean:

\begin{verbatim}
	<kind> flow from <source> to <target> [<guard>]
	
	control flow from activity1 to activity2
	control flow from activity1 to activity2 [x == 10]
	data flow from activity1.pin1 to activity2.pin2
	data flow from self.pin to activity3.pin2
\end{verbatim}

\subsubsection*{Declarations}

Activity declarations state the \emph{name} of the activity, as well as its \emph{pins} \ref{sssec:pins}. 


\begin{lstlisting}
	activity Example (
		..pins..
	) {
		..body..
	}
\end{lstlisting}

You can also declare activities inline by using the \verb|:| operator:

\begin{lstlisting}
	activity Example {
		action InlineActivityExample : activity
	}
\end{lstlisting}

\subsubsection*{Definitions}

Activities also have definitions, which give them bodies. The body language can be either \verb|activity| or \verb|action| depending on the language metadata set. Using the \verb|action| language let's you use any Gamma Action expression, including timeout resetting, raising events through component ports, or simple arithmetic operations.

An example activity defined by an action body:

\begin{lstlisting}
	activity Example (
		in x : integer,
		out y : integer
	) [language=action] {
		self.y := self.x * 2;
	}
\end{lstlisting}

Inline activities may also have pins and be defined using action language:

\begin{lstlisting}
	activity Example {
		action InlineActivityExample : activity (
			in input : integer,
			out output : integer
		) [language=action] {
			self.output := self.input;
		}
	}
\end{lstlisting}

\subsection{Integration into Gamma}\label{ssec:integration-into-gamma}
